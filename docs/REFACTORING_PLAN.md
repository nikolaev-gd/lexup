# План рефакторинга 'lib/full_text_screen.dart'

## Цель рефакторинга
Разделить код в файле 'lib/full_text_screen.dart' на отдельные файлы для улучшения структуры, читаемости и поддерживаемости кода.

## Шаги рефакторинга

1. ✅ Создание отдельного файла для виджета FullTextScreen
   - Что: Выделить класс FullTextScreen в отдельный файл
   - Почему: Улучшит организацию кода и облегчит навигацию
   - Тест: Убедиться, что приложение компилируется и FullTextScreen отображается корректно
   - Откат: Удалить новый файл и вернуть код в original_full_text_screen.dart
   - Статус: Выполнено и протестировано успешно

2. ✅ Создание сервиса для работы с API
   - Что: Выделить логику работы с API в отдельный сервис
   - Почему: Отделит бизнес-логику от UI, улучшит тестируемость
   - Тест: Проверить основные функции приложения, использующие API
   - Откат: Удалить новый файл и вернуть код API в FullTextScreen
   - Статус: Выполнено и протестировано успешно

3. ✅ Создание сервиса для работы с Firestore
   - Что: Выделить логику работы с Firestore в отдельный сервис
   - Почему: Централизует работу с базой данных, упростит поддержку
   - Тест: Проверить основные функции приложения, использующие Firestore
   - Откат: Удалить новый файл и вернуть код Firestore в FullTextScreen
   - Статус: Выполнено и протестировано успешно

4. ✅ Создание модели для карточек
   - Что: Создать класс модели для представления карточек
   - Почему: Улучшит типизацию и облегчит работу с данными
   - Тест: Убедиться, что модель корректно сериализуется/десериализуется
   - Откат: Удалить файл модели и вернуться к использованию Map
   - Статус: Выполнено и протестировано успешно

5. Выделение виджетов
   - Что: Создать отдельные файлы для ClickableText и SavedCards виджетов
   - Почему: Улучшит читаемость кода и переиспользуемость компонентов
   - Тест: Убедиться, что виджеты отображаются корректно в FullTextScreen
   - Откат: Удалить новые файлы и вернуть код виджетов в FullTextScreen

6. Создание утилитарного класса
   - Что: Выделить вспомогательные функции (например, _fixEncoding) в утилитарный класс
   - Почему: Централизует общие функции, улучшит переиспользуемость
   - Тест: Написать unit-тесты для утилитарных функций
   - Откат: Удалить утилитарный класс и вернуть функции в FullTextScreen

## Процесс рефакторинга

Каждый шаг рефакторинга выполняется отдельно и последовательно. После каждого шага проводится тестирование для убеждения в корректности внесенных изменений. В случае возникновения проблем производится откат изменений и анализ причин ошибок.

После каждого протестированного изменения этот файл (REFACTORING_PLAN.md) обновляется, отражая текущий статус рефакторинга и любые возникшие проблемы или замечания.

## Ожидаемый результат

После завершения рефакторинга мы ожидаем получить более структурированный и легко поддерживаемый код. Это должно упростить дальнейшую разработку и расширение функциональности приложения.

## Текущий прогресс

- ✅ Шаг 1: Выполнен и успешно протестирован
- ✅ Шаг 2: Выполнен и успешно протестирован
- ✅ Шаг 3: Выполнен и успешно протестирован
- ✅ Шаг 4: Выполнен и успешно протестирован

## Заметки

- Рефакторинг Firestore сервиса прошел успешно. Все функции, связанные с Firestore (загрузка упрощенного текста, сохранение и удаление карточек, отображение сохраненных карточек), работают корректно после выделения их в отдельный сервис.
- Следующим шагом будет выделение виджетов ClickableText и SavedCards в отдельные файлы, что должно улучшить читаемость кода и переиспользуемость компонентов.
