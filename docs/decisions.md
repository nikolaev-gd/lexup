# Технические решения проекта LexUp

Этот документ предназначен для документирования важных технических решений, принятых в ходе разработки проекта LexUp. Каждое решение должно быть тщательно обдумано и задокументировано в соответствии с приведенным ниже шаблоном.

## Когда документировать решение

Решение должно быть задокументировано, если оно:
1. Влияет на архитектуру проекта
   - Изменение структуры проекта
   - Добавление новых архитектурных слоев
   - Изменение паттернов проектирования

2. Затрагивает технологический стек
   - Добавление новых библиотек или фреймворков
   - Изменение существующих технологий
   - Интеграция новых сервисов

3. Существенно влияет на производительность
   - Оптимизация критических операций
   - Изменение способов хранения или обработки данных
   - Модификация процессов, влияющих на UX

4. Имеет долгосрочные последствия
   - Решения, которые сложно изменить в будущем
   - Выбор, влияющий на развитие проекта
   - Решения с существенными затратами ресурсов

## Шаблон для документирования решения

### [Краткое название решения]

**Дата:** YYYY-MM-DD

**Контекст и проблема:**
- Какая проблема решается?
- Почему это важно сейчас?
- Какие ограничения существуют?

**Рассмотренные альтернативы:**
1. Альтернатива 1
   - Преимущества
   - Недостатки
   - Почему не подходит

2. Альтернатива 2
   - Преимущества
   - Недостатки
   - Почему не подходит

**Принятое решение:**
- Четкое описание выбранного решения
- Конкретные шаги по реализации
- Технические детали, если необходимо

**Обоснование:**
- Почему это решение лучше альтернатив?
- Как оно решает исходную проблему?
- Какие преимущества дает проекту?

**Последствия:**
- Положительные эффекты
- Возможные риски
- Необходимые действия для минимизации рисков

## Пример заполнения

### Выбор способа кэширования данных

**Дата:** 2024-01-20

**Контекст и проблема:**
- Частые запросы к API приводят к задержкам в работе приложения
- Необходимо оптимизировать использование сетевых ресурсов
- Ограничение: размер локального хранилища на устройстве

**Рассмотренные альтернативы:**
1. In-memory кэширование
   - Преимущества: быстрый доступ к данным
   - Недостатки: данные теряются при перезапуске приложения
   - Не подходит из-за потери данных

2. Shared Preferences
   - Преимущества: простота реализации
   - Недостатки: ограничения по объему и типам данных
   - Не подходит для сложных структур данных

3. SQLite база данных
   - Преимущества: структурированное хранение, поддержка запросов
   - Недостатки: сложность настройки и поддержки
   - Избыточно для простого кэширования

**Принятое решение:**
Использовать Hive для локального кэширования данных:
- Хранить ответы API в течение определенного времени
- Автоматически обновлять устаревшие данные
- Ограничить размер кэша

**Обоснование:**
- Простой API для работы с данными
- Хорошая производительность
- Поддержка сложных типов данных
- Небольшой размер библиотеки

**Последствия:**
- Уменьшение количества сетевых запросов
- Улучшение отзывчивости приложения
- Необходимость управления жизненным циклом кэша

## Принятые решения

### Обработка и отображение слов в карточках

**Дата:** 2024-12-10

**Контекст и проблема:**
- При отображении карточек слов возникли проблемы с форматированием заголовков
- Слова с пунктуацией (например, "all).") не находились в тексте фразы
- Многословные выражения (например, "no work at all") не выделялись корректно
- Система предполагала, что искомое слово всегда находится в начале фразы

**Рассмотренные альтернативы:**
1. Простая очистка пунктуации
   - Преимущества: простота реализации
   - Недостатки: теряется оригинальное форматирование
   - Не подходит из-за потери важной информации

2. Регулярные выражения для поиска
   - Преимущества: гибкость поиска
   - Недостатки: сложность поддержки, возможные ошибки
   - Не подходит из-за сложности обработки всех случаев

3. Хранение позиции слова
   - Преимущества: точное позиционирование
   - Недостатки: усложнение структуры данных
   - Не подходит из-за избыточности

**Принятое решение:**
Реализовать интеллектуальный поиск и форматирование слов:

1. Очистка слов при поиске:
```dart
String _cleanWord(String word) {
  return word.replaceAll(RegExp(r'[^\w\s\-]'), '').trim().toLowerCase();
}
```

2. Поиск слова как части фразы:
```dart
// Ищем слово как часть фразы
for (int i = 0; i < parts.length; i++) {
  String currentPart = '';
  for (int j = i; j < parts.length; j++) {
    if (currentPart.isNotEmpty) currentPart += ' ';
    currentPart += parts[j];
    if (currentPart == cleanWord) {
      startIndex = i;
      endIndex = j;
      break;
    }
  }
  if (startIndex != -1) break;
}
```

3. Правильное разделение фразы:
```dart
final beforeWord = originalParts.take(startIndex).join(' ');
final wordPart = originalParts.skip(startIndex).take(endIndex - startIndex + 1).join(' ');
final afterWord = originalParts.skip(endIndex + 1).join(' ');
```

**Обоснование:**
- Сохраняет оригинальное форматирование текста
- Корректно обрабатывает слова с пунктуацией
- Поддерживает многословные выражения
- Находит слова в любой позиции фразы

**Последствия:**
Положительные:
- Корректное отображение всех типов слов и фраз
- Единообразное форматирование во всем приложении
- Улучшенный пользовательский опыт

Возможные риски:
- Небольшое увеличение сложности кода
- Потенциальные проблемы с производительностью при длинных текстах

Минимизация рисков:
- Подробное документирование логики
- Добавление отладочной информации
- Тестирование на различных сценариях

## Как вести документацию

### Процесс документирования решения

1. Перед принятием решения:
   - Четко определите проблему
   - Исследуйте возможные альтернативы
   - Оцените последствия каждого варианта

2. При заполнении шаблона:
   - Будьте конкретны в описаниях
   - Используйте технические термины правильно
   - Приводите четкие аргументы

3. После документирования:
   - Получите обратную связь от команды
   - Убедитесь, что все понимают решение
   - Обновите связанные документы

### Рекомендации по заполнению разделов

**Контекст и проблема:**
- Опишите ситуацию, которая привела к необходимости решения
- Укажите конкретные проблемы и их влияние на проект
- Перечислите существующие ограничения

**Рассмотренные альтернативы:**
- Включите все серьезно рассмотренные варианты
- Для каждой альтернативы укажите преимущества и недостатки
- Объясните, почему альтернатива не была выбрана

**Принятое решение:**
- Четко опишите выбранное решение
- Укажите конкретные шаги по реализации
- Добавьте технические детали, если они важны

**Обоснование:**
- Объясните, почему это решение лучше альтернатив
- Укажите, как оно решает исходную проблему
- Опишите преимущества для проекта

**Последствия:**
- Перечислите ожидаемые положительные эффекты
- Укажите возможные риски и проблемы
- Опишите меры по минимизации рисков

### Обновление документа

1. Добавление нового решения:
   - Создайте новую секцию в начале списка решений
   - Следуйте формату шаблона
   - Обновите оглавление, если оно есть

2. Обновление существующего решения:
   - Добавьте новую информацию в соответствующий раздел
   - Укажите дату обновления
   - Сохраните историю изменений

3. Связи с другими документами:
   - Добавляйте ссылки на связанные документы
   - Обновляйте ссылки при изменении структуры
   - Поддерживайте консистентность документации
